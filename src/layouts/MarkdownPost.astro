---
import BaseLayout from '../layouts/BaseLayout.astro';

import type { CollectionEntry } from 'astro:content';

type Props = CollectionEntry<'blog'>['data'];

const { frontmatter, headings } = Astro.props;
---
<BaseLayout title={frontmatter.title}>
    
    <div class="prose dark:prose-invert py-4">
        <p>{frontmatter.pubDate}</p>
    </div>

    <div class="grid grid-cols-12 gap-6">
        <article class="col-span-12 md:col-span-9">
            <div class="prose dark:prose-invert">
                <slot />
            </div>
        </article>
        
        <aside class="hidden h-max sticky top-5 md:block md:col-span-3">
          <nav class="toc">
            <h4>Table of Contents</h4>
            <ul class="text-xs m-0 p-0">
                {headings.map((heading: any) => {
                    let className = `list-none mx-0 my-1 `
                    if (heading.depth >=2 && heading.depth < 5) {
                        switch (heading.depth) {
                        case 2:
                            className += `pl-0`;
                            break;
                        case 3:
                            className += `pl-4`;
                            break;
                        case 4:
                            className += `pl-8`;
                            break;
                        default:
                            break;
                        }
                        return <li class={className}>
                            <a href={`#${heading.slug}`} class="link link-primary link-hover">
                                {heading.text}
                            </a>
                        </li>
                      }
                    }
                  )}
            </ul>
          </nav>
        </aside>
    </div>

    <div class="flex flex-wrap gap-2">
        {frontmatter.tags.map((tag: any) => (
          <a href={`/tags/${tag}`} class="btn btn-neutral text-xs"># {tag}</a>
        ))}
    </div>

</BaseLayout>